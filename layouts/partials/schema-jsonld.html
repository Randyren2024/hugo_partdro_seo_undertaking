{{/* 结构化数据 - Schema.org JSON-LD */}}
{{/* Website Schema */}}
{{ if .IsHome }}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": {{ .Site.Title | jsonify }},
  "url": {{ .Site.BaseURL | jsonify }},
  "description": {{ with .Site.Params.description }}{{ . | jsonify }}{{ else }}""{{ end }},
  "potentialAction": {
    "@type": "SearchAction",
    "target": {
      "@type": "EntryPoint",
      "urlTemplate": {{ printf "%s?s={search_term_string}" .Site.BaseURL | jsonify }}
    },
    "query-input": "required name=search_term_string"
  }
}
</script>
{{ end }}

{{/* Organization Schema */}}
{{ if .IsHome }}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": {{ .Site.Title | jsonify }},
  "url": {{ .Site.BaseURL | jsonify }},
  "logo": {{ with .Site.Params.logo }}{{ . | absURL | jsonify }}{{ else }}""{{ end }},
  "description": {{ with .Site.Params.description }}{{ . | jsonify }}{{ else }}""{{ end }},
  "sameAs": [
    {{ with .Site.Params.social.twitter }}"{{ . }}"{{ end }}{{ if and .Site.Params.social.twitter .Site.Params.social.linkedin }},{{ end }}
    {{ with .Site.Params.social.linkedin }}"{{ . }}"{{ end }}{{ if and .Site.Params.social.linkedin .Site.Params.social.github }},{{ end }}
    {{ with .Site.Params.social.github }}"{{ . }}"{{ end }}{{ if and .Site.Params.social.github .Site.Params.social.facebook }},{{ end }}
    {{ with .Site.Params.social.facebook }}"{{ . }}"{{ end }}{{ if and .Site.Params.social.facebook .Site.Params.social.instagram }},{{ end }}
    {{ with .Site.Params.social.instagram }}"{{ . }}"{{ end }}{{ if and .Site.Params.social.instagram .Site.Params.social.youtube }},{{ end }}
    {{ with .Site.Params.social.youtube }}"{{ . }}"{{ end }}
  ]
}
</script>
{{ end }}

{{/* Article/BlogPosting Schema */}}
{{ if or (eq .Type "blog") (eq .Type "post") }}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": {{ .Title | jsonify }},
  "description": {{ with .Description }}{{ . | jsonify }}{{ else }}{{ with .Summary }}{{ . | plainify | jsonify }}{{ else }}""{{ end }}{{ end }},
  "image": {{ with .Params.image }}{{ . | absURL | jsonify }}{{ else }}{{ with .Site.Params.image }}{{ . | absURL | jsonify }}{{ else }}""{{ end }}{{ end }},
  "url": {{ .Permalink | jsonify }},
  "datePublished": {{ .Date.Format "2006-01-02T15:04:05-07:00" | jsonify }},
  "dateModified": {{ with .Lastmod }}{{ .Format "2006-01-02T15:04:05-07:00" | jsonify }}{{ else }}{{ .Date.Format "2006-01-02T15:04:05-07:00" | jsonify }}{{ end }},
  "author": {
    "@type": "Person",
    "name": {{ with .Params.author }}{{ . | jsonify }}{{ else }}{{ .Site.Params.author | jsonify }}{{ end }}
  },
  "publisher": {
    "@type": "Organization",
    "name": {{ .Site.Title | jsonify }},
    "logo": {
      "@type": "ImageObject",
      "url": {{ with .Site.Params.logo }}{{ . | absURL | jsonify }}{{ else }}""{{ end }}
    }
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": {{ .Permalink | jsonify }}
  }
  {{ with .Params.keywords }},
  "keywords": {{ delimit . ", " | jsonify }}
  {{ end }}
  {{ with .Params.categories }},
  "articleSection": {{ index . 0 | jsonify }}
  {{ end }}
}
</script>
{{ end }}

{{/* BreadcrumbList Schema */}}
{{ if not .IsHome }}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "首页",
      "item": {{ .Site.BaseURL | jsonify }}
    }
    {{ if not .IsSection }},
    {
      "@type": "ListItem",
      "position": 2,
      "name": {{ .Section | humanize | jsonify }},
      "item": {{ printf "%s%s/" .Site.BaseURL .Section | jsonify }}
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": {{ .Title | jsonify }},
      "item": {{ .Permalink | jsonify }}
    }
    {{ else }},
    {
      "@type": "ListItem",
      "position": 2,
      "name": {{ .Title | jsonify }},
      "item": {{ .Permalink | jsonify }}
    }
    {{ end }}
  ]
}
</script>
{{ end }}

{{/* WebPage Schema - 通用页面 */}}
{{ if and (not .IsHome) (not (or (eq .Type "blog") (eq .Type "post"))) }}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": {{ .Title | jsonify }},
  "description": {{ with .Description }}{{ . | jsonify }}{{ else }}{{ with .Site.Params.description }}{{ . | jsonify }}{{ else }}""{{ end }}{{ end }},
  "url": {{ .Permalink | jsonify }},
  {{ with .Params.image }}
  "image": {{ . | absURL | jsonify }},
  {{ end }}
  "isPartOf": {
    "@type": "WebSite",
    "name": {{ .Site.Title | jsonify }},
    "url": {{ .Site.BaseURL | jsonify }}
  }
  {{ with .Date }},
  "datePublished": {{ .Format "2006-01-02T15:04:05-07:00" | jsonify }}
  {{ end }}
  {{ with .Lastmod }},
  "dateModified": {{ .Format "2006-01-02T15:04:05-07:00" | jsonify }}
  {{ end }}
}
</script>
{{ end }}

{{/* FAQPage Schema - 用于FAQ页面 */}}
{{ if eq .Type "faq" }}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {{ range $index, $faq := .Params.faqs }}
    {{ if $index }},{{ end }}
    {
      "@type": "Question",
      "name": {{ $faq.question | jsonify }},
      "acceptedAnswer": {
        "@type": "Answer",
        "text": {{ $faq.answer | jsonify }}
      }
    }
    {{ end }}
  ]
}
</script>
{{ end }}
